---
title: "STAT 443 Project"
author: "Subin Cho"
date: "3/5/2021"
output: pdf_document
---

```{r echo = FALSE, warning = FALSE}
library(dplyr, warn.conflicts = FALSE)
library(ggplot2)
```

```{r}
# read data: Gas Turbine CO and NOx Emission
gt_2012 = read.csv('gt_2012.csv')
```

```{r}
str(gt_2012)
```

The dataset contains 7628 instances of 11 sensor measures aggregated over one hour (by means of average or sum) from a gas turbine in 2012 located in Turkey's north western region for the purpose of studying flue gas emissions, namely CO and NOx (NO + NO2).

- `AT`: Ambient temperature (C)
- `AP`: Ambient pressure (mbar) 
- `AH`: Ambient humidity (%) 

- `AFDP`: Air filter difference pressure (mbar)
- `GTEP`: Gas turbine exhaust pressure (mbar)
- `TIT`: Turbine inlet temperature (C)
- `TAT`: Turbine after temperature (C)
- `CDP`: Compressor discharge pressure (mbar)

- `TEY`: Turbine energy yield (MWH)

- `CO`: Carbon monoxide (mg/m3)
- `NOX`: Nitrogen oxides (mg/m3)


```{r echo = FALSE}
# AT, AP, AH
p_AT = gt_2012 %>% 
  ggplot(aes(x = AT)) +
  geom_density(color = 'dodgerblue') + theme(legend.position = "none")

p_AP = gt_2012 %>% 
  ggplot(aes(x = AP)) +
  geom_density(color = 'dodgerblue') + theme(legend.position = "none")

p_AH = gt_2012 %>% 
  ggplot(aes(x = AH)) +
  geom_density(color = 'dodgerblue') + theme(legend.position = "none")

# AFDP, GTEP, TIT, TAT, CDP
p_AFDP = gt_2012 %>% 
  ggplot(aes(x = AFDP)) +
  geom_density(color = 'darkred') + theme(legend.position = "none")

p_GTEP = gt_2012 %>% 
  ggplot(aes(x = GTEP)) +
  geom_density(color = 'darkred') + theme(legend.position = "none")

p_TIT = gt_2012 %>% 
  ggplot(aes(x = TIT)) +
  geom_density(color = 'darkred') + theme(legend.position = "none")

p_TAT = gt_2012 %>% 
  ggplot(aes(x = TAT)) +
  geom_density(color = 'darkred') + theme(legend.position = "none")

p_CDP = gt_2012 %>% 
  ggplot(aes(x = CDP)) +
  geom_density(color = 'darkred') + theme(legend.position = "none")

# TEY
p_TEY = gt_2012 %>% 
  ggplot(aes(x = TEY)) +
  geom_density(color = 'darkgreen') + theme(legend.position = "none")

# CO, NOX
p_CO = gt_2012 %>% 
  ggplot(aes(x = CO)) + 
  geom_density(color = 'darkorange') + theme(legend.position = "none")

p_NOX = gt_2012 %>% 
  ggplot(aes(x = NOX)) +
  geom_density(color = 'darkorange') + theme(legend.position = "none")
```

```{r, fig.height = 15, fig.width = 15, echo = FALSE}
gridExtra::grid.arrange(p_AT, p_AP, p_AH,
                        p_AFDP, p_GTEP, p_TIT, p_TAT, p_CDP,
                        p_TEY,
                        p_CO, p_NOX, ncol = 3)
```

## CO emissions
```{r}
mod_co1 = lm(CO ~ . - NOX, data = gt_2012)
summary(mod_co1)
```

```{r}
# remove AFDP
mod_co2 = lm(CO ~ . - NOX - AFDP, data = gt_2012)
summary(mod_co2)
```

- Backward Search
```{r}
# BIC
mod_co_back1 = step(mod_co2, direction = "backward")
coef(mod_co_back1)
```
```{r}
# AIC
mod_co_start = lm(CO ~ 1 - NOX, data = gt_2012)
mod_co_forw_aic = step(mod_co_start, 
  scope = CO ~ AT + AP + AH + AFDP + GTEP + TIT + TAT + TEY + CDP, 
  direction = "forward")
```
```{r}
# stepwise
mod_co_start = lm(CO ~ 1 - NOX, data = gt_2012)
mod_co_both_aic = step(mod_co_start, 
  scope = CO ~ AT + AP + AH + AFDP + GTEP + TIT + TAT + TEY + CDP, 
  direction = "both")
```



## $NO_x$ emissions
```{r}
mod_nox1 = lm(NOX ~ . - CO, data = gt_2012)
summary(mod_nox1)
```

```{r}
# Is this our another response variable?
```





